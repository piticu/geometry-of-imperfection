# Geometry of Imperfection

**A statistical and visual exploration of layout variations in manually printed books.**

This project investigates the phenomenon of “moving margins” in scanned books—the subtle shifts in text block position caused not by scanning errors, but by the physical realities of historical printing: paper drift, folding misalignment, and imperfect trimming.

We use a two-step Python workflow. First, we extract bounding boxes from scanned pages using the Google Cloud Vision API. Second, we parse these raw results into a clean, consolidated CSV dataset. This allows us to filter, analyze, and generate visualizations that reveal the geometry of error and intent in old books.

## 🧠 Project Goals

- Analyze hundreds of scanned pages from old printed books.
- Identify and measure variation in text block position and skew using the Google Vision API.
- **Consolidate raw detection data into a clean, reusable CSV dataset.**
- Filter out anomalous pages (title pages, blanks, heavily skewed scans).
- Visualize consistent patterns versus production "outliers" using a heatmap.
- Offer reusable tools for similar research in digital humanities.

## 📁 Repository Contents

The project is structured into a two-script pipeline: one for data extraction and one for data consolidation.

```
geometry-of-imperfection/
├── calcule.py                            # 1. Main analysis and visualization script (populates cache)
├── analiza_cache.py                      # 2. Utility script to create the final CSV from cache
├── rezultate_inainte_de_scantailor.csv   # The final, consolidated dataset
├── cache_google_vision/                  # Cached API results as .txt files (not tracked)
├── .gitignore
└── README.md
```

- **`calcule.py`**: The main script for page-by-page analysis. It calls the Google Vision API, populates the cache with individual `.txt` files, and generates the final heatmap visualization.
- **`analiza_cache.py`**: A utility script that parses all files in the cache directory, consolidates them into a single structured dataset, and saves it as a CSV file.
- **`rezultate_inainte_de_scantailor.csv`**: The final, consolidated dataset generated by `analiza_cache.py`. Contains bounding box coordinates and skew for every processed page.
- **`cache_google_vision/`**: A directory containing the raw output from the Google Vision API for each page, saved as a separate `.txt` file. This prevents duplicate API calls and saves costs.

## 🚀 How to Use

The workflow is a two-step process: first, generate the data cache, then consolidate it.

1.  Make sure you have Python 3 and the required libraries:
    ```bash
    pip install -r requirements.txt
    ```
2.  Place your scanned page images in the project's root directory or specify the path in `calcule.py`.
3.  **Step 1: Populate the Cache & Generate Visualization**

    Run the main analysis script. This will process each image, call the API (if not already in cache), and save the results in the `cache_google_vision/` directory. It will also create the heatmap image.
    ```bash
    python3 calcule.py
    ```
4.  **Step 2: Consolidate Data into CSV**

    Once the cache is populated, run the analysis script to combine all the individual `.txt` cache files into a single, clean CSV file.
    ```bash
    python3 analiza_cache.py
    ```

After these steps, you will have the raw cache, the final `rezultate_inainte_de_scantailor.csv` dataset, and the heatmap visualization image, ready for further analysis or use in other tools.

## 🔗 Live Dataset

All code and analysis are in this repository. The final dataset generated by the pipeline is **`rezultate_inainte_de_scantailor.csv`**. The project is designed to be modular—feel free to adapt the pipeline to your own scanned materials or research questions.

## 📖 Background

This project was inspired by the subtle, often-overlooked signs of human craft in historical printing. By quantifying imperfection, we aim to rediscover the ideal geometry printers and bookbinders once pursued.

> “Looking at that ghostly image, with its perfectly averaged blue rectangle, we don’t just see pixels.
> We glimpse a bridge across time—a statistical attempt to rediscover the craftsman’s ideal.”

## 📜 License

This project is licensed under the [MIT License](LICENSE).

---

**Made with 🐍 Python and a love for imperfect books.**
